[
  {
    "objectID": "pensamiento.html",
    "href": "pensamiento.html",
    "title": "Pensamiento Bayesiano",
    "section": "",
    "text": "Librerías:\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(LearnBayes)\n\n\n\n\nPregunta de investigación: ¿Qué proporción de estudiantes universitarios duermen al menos 8 horas diarias?\nNotación: \\(p\\): proporción de estudiantes que duermen al menos 8 horas diarias.\nDatos: Muestra de 27 estudiantes donde 11 sí durmieron al menos 8 horas ayer.\nModelo: \\[L(p)\\propto p^s(1-p)^f\\]\nDistribución posterior: Si \\(g(p)\\) es la densidad previa de \\(p\\), entonces: \\[g(p|\\text{datos})\\propto g(p)L(p)\\] Primera escogencia de previa \\(g(p)\\)\n\n\np &lt;- seq(0.05,0.95,by = 0.1)\nprevia &lt;- c(1,5.2,8,7.2,4.6,2.1,0.7,0.1,0,0)\nprevia &lt;- previa / sum(previa)\nplot(p, previa, type = \"h\", ylab=\"Probabilidad previa\")\n\n\n\n\n\ndatos_sleep &lt;- c(11, 16)\ndatos_tot &lt;- data.frame(p = p, previa = previa)\ndatos_tot &lt;- datos_tot %&gt;% mutate(posterior = previa* p^(11)*(1-p)^(16)) %&gt;%\n  mutate(posterior = posterior/sum(posterior)) \nround(datos_tot,2)\n\n      p previa posterior\n1  0.05   0.03      0.00\n2  0.15   0.18      0.00\n3  0.25   0.28      0.13\n4  0.35   0.25      0.48\n5  0.45   0.16      0.33\n6  0.55   0.07      0.06\n7  0.65   0.02      0.00\n8  0.75   0.00      0.00\n9  0.85   0.00      0.00\n10 0.95   0.00      0.00\n\n\nComparación:\n\ndatos_tot_long &lt;- datos_tot %&gt;%\n  pivot_longer(previa:posterior,names_to = 'Type',values_to = 'Probability')\n\nggplot(datos_tot_long, aes(x = p, y = Probability, group = Type, color = Type)) +\n  geom_line(linewidth = 3) +\n  facet_wrap(~ Type, nrow =  2) +\n  theme_minimal()\n\n\n\n\nSegunda escogencia de previa \\(g(p)\\)"
  },
  {
    "objectID": "pensamiento.html#ejemplo-1",
    "href": "pensamiento.html#ejemplo-1",
    "title": "1  Pensamiento Bayesiano",
    "section": "1.1 Ejemplo 1",
    "text": "1.1 Ejemplo 1\n\nPregunta de investigación: ¿Qué proporción de estudiantes universitarios duermen al menos 8 horas diarias?\nNotación: \\(p\\): proporción de estudiantes que duermen al menos 8 horas diarias.\nDatos: Muestra de 27 estudiantes donde 11 sí durmieron al menos 8 horas ayer.\nModelo: \\[L(p)\\propto p^s(1-p)^f\\]\nDistribución posterior: Si \\(g(p)\\) es la densidad previa de \\(p\\), entonces: \\[g(p|\\text{datos})\\propto g(p)L(p)\\] Primera escogencia de previa \\(g(p)\\)\n\n\np &lt;- seq(0.05,0.95,by = 0.1)\nprevia &lt;- c(1,5.2,8,7.2,4.6,2.1,0.7,0.1,0,0)\nprevia &lt;- previa / sum(previa)\nplot(p, previa, type = \"h\", ylab=\"Probabilidad previa\")\n\n\n\n\n\ndatos_sleep &lt;- c(11, 16)\ndatos_tot &lt;- data.frame(p = p, previa = previa)\ndatos_tot &lt;- datos_tot %&gt;% mutate(posterior = previa* p^(11)*(1-p)^(16)) %&gt;%\n  mutate(posterior = posterior/sum(posterior)) \nround(datos_tot,2)\n\n      p previa posterior\n1  0.05   0.03      0.00\n2  0.15   0.18      0.00\n3  0.25   0.28      0.13\n4  0.35   0.25      0.48\n5  0.45   0.16      0.33\n6  0.55   0.07      0.06\n7  0.65   0.02      0.00\n8  0.75   0.00      0.00\n9  0.85   0.00      0.00\n10 0.95   0.00      0.00\n\n\nComparación:\n\ndatos_tot_long &lt;- datos_tot %&gt;%\n  pivot_longer(previa:posterior,names_to = 'Type',values_to = 'Probability')\n\nggplot(datos_tot_long, aes(x = p, y = Probability, group = Type, color = Type)) +\n  geom_line(linewidth = 3) +\n  facet_wrap(~ Type, nrow =  2) +\n  theme_minimal()\n\n\n\n\nSegunda escogencia de previa \\(g(p)\\)\nEscogencia de los parámetros de la Beta:\n\nquantile1 &lt;- list(p = .5,x=.3)\nquantile2 &lt;- list(p=.9,x=.5)\nbeta.select(quantile1,quantile2)\n\n[1] 3.26 7.19\n\n\nComparación de densidades:\n\na &lt;- 3.26\nb &lt;- 7.19\ns &lt;- 11\nf &lt;- 16\n\nx_values &lt;- seq(0, 1, length.out = 1000)\ndf &lt;- data.frame(x = x_values,\n                 Prior = dbeta(x_values, a, b),\n                 Likelihood = dbeta(x_values, s + 1, f + 1),\n                 Posterior = dbeta(x_values, a + s, b + f))\n\n\nggplot(df, aes(x)) +\n  geom_line(aes(y = Prior), linetype = \"dashed\", size = 1.5, color = \"blue\") +\n  geom_line(aes(y = Likelihood), linetype = \"dotted\", size = 1.5, color = \"green\") +\n  geom_line(aes(y = Posterior), size = 1.5, color = \"red\") +\n  labs(x = \"p\", y = \"Density\") +\n  theme_minimal() +\n  scale_color_manual(values = c(\"blue\", \"green\", \"red\")) +\n  theme(legend.position = \"top\") +\n  guides(color = guide_legend(title = \"Density\"))\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\nPara responder parcialmente la pregunta de investigación:\n\n1 - pbeta(0.5, a + s, b + f)\n\n[1] 0.0690226\n\n\nes decir hay una probabilidad aproximadamente de 7% de que más de la mitad de los estudiantes universitarios duerman más de 8 horas diarias. O bien, si se quiere calcular la probabilidad de que la proporción de estudiantes sea mayor a lo observado:\n\n1 - pbeta(11/27, a + s, b + f)\n\n[1] 0.3603559\n\n\nIntervalo de credibilidad para \\(p\\):\n\nqbeta(c(0.05, 0.95), a + s, b + f)\n\n[1] 0.2555267 0.5133608\n\n\nen donde se infiere que \\(p\\) tiene una probabilidad del 95% de estar ubicado entre esos dos valores. El resultado anterior que es exacto, se puede aproximar usando simulación:\n\nps &lt;- rbeta(1000, a + s, b + f)\nhist(ps,xlab=\"p\",main=\"\")\n\n\n\n\ny la probabilidad de que \\(p&gt;0.5|\\text{datos}\\) se puede aproximar empíricamente:\n\nsum(ps &gt;= 0.5)/1000\n\n[1] 0.086\n\n\ny el intervalo de credibilidad correspondiente:\n\nquantile(ps, c(0.05, 0.95))\n\n       5%       95% \n0.2515219 0.5183528 \n\n\n\n1.1.1 Predicción\nBajo la primera previa:\n\np &lt;- seq(0.05, 0.95, by=.1)\nprior &lt;- c(1, 5.2, 8, 7.2, 4.6, 2.1, 0.7, 0.1, 0, 0)\nprior &lt;- prior/sum(prior)\nm &lt;- 20\nys &lt;- 0:20\npred &lt;- pdiscp(p, prior, m, ys)\nround(cbind(0:20,pred),3)\n\n          pred\n [1,]  0 0.020\n [2,]  1 0.044\n [3,]  2 0.069\n [4,]  3 0.092\n [5,]  4 0.106\n [6,]  5 0.112\n [7,]  6 0.110\n [8,]  7 0.102\n [9,]  8 0.089\n[10,]  9 0.074\n[11,] 10 0.059\n[12,] 11 0.044\n[13,] 12 0.031\n[14,] 13 0.021\n[15,] 14 0.013\n[16,] 15 0.007\n[17,] 16 0.004\n[18,] 17 0.002\n[19,] 18 0.001\n[20,] 19 0.000\n[21,] 20 0.000\n\n\nBajo la segunda previa (beta):\n\nfy &lt;- choose(m,ys)*beta(a+ys,b = b+m-ys)/beta(a,b)\nab &lt;- c(3.26, 7.19)\npred &lt;- pbetap(ab, m, ys)\n\nO por simulación:\n\np &lt;- rbeta(1000, 3.26, 7.19)\ny &lt;- rbinom(1000, 20, p)\ntable(y)\n\ny\n  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17 \n 18  44  67  87 102 104 124 108  80  82  56  36  37  25  15   5   6   4 \n\n\n\nfreq &lt;- table(y)\nys &lt;- as.integer(names(freq))\npredprob &lt;- freq / sum(freq)\n\ndf &lt;- data.frame(ys = ys, predprob = predprob)\n\n\nggplot(df, aes(x = ys, y = predprob)) +\n  geom_line(stat = \"identity\", type = \"h\", color = \"blue\", size = 1.5) +\n  labs(x = \"y\", y = \"Predictive Probability\") +\n  theme_minimal()\n\nWarning in geom_line(stat = \"identity\", type = \"h\", color = \"blue\", size =\n1.5): Ignoring unknown parameters: `type`\n\n\nDon't know how to automatically pick scale for object of type &lt;table&gt;.\nDefaulting to continuous.\n\n\n\n\n\nCálculo de intervalo de credibilidad al 90% usando la probabilidad predictiva anterior:\n\ndist &lt;- cbind(ys,predprob)\ncovprob &lt;- .9\ndiscint(dist,covprob)\n\n$prob\n   11 \n0.927 \n\n$set\n 1  2  3  4  5  6  7  8  9 10 11 12 \n 1  2  3  4  5  6  7  8  9 10 11 12"
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "Summary",
    "section": "",
    "text": "Summary\nIn summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "References"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Inferencia Bayesiana",
    "section": "",
    "text": "Prefacio\nNotas computacionales del curso XS0128 (Inferencia Bayesiana) para el I-2024."
  },
  {
    "objectID": "pensamiento.html#ejemplo-2",
    "href": "pensamiento.html#ejemplo-2",
    "title": "1  Pensamiento Bayesiano",
    "section": "1.2 Ejemplo 2",
    "text": "1.2 Ejemplo 2"
  },
  {
    "objectID": "pensamiento.html#ejemplo-3",
    "href": "pensamiento.html#ejemplo-3",
    "title": "1  Pensamiento Bayesiano",
    "section": "1.3 Ejemplo 3",
    "text": "1.3 Ejemplo 3\nLos siguientes datos simulan el sexo de 200 recién nacidos, en donde 1 denota niño y 0 denota niña.\n\nrecien_n\n\n  [1] 1 1 1 0 1 1 1 1 0 1 0 0 1 0 1 1 1 1 1 0 0 0 0 1 1 0 0 1 0 1 1 1 1 0 1 0 0\n [38] 0 0 1 1 1 1 0 1 1 1 1 1 0 1 0 1 1 1 0 1 1 1 1 1 1 1 1 0 0 0 1 1 1 1 1 0 1\n [75] 1 1 1 0 1 1 0 1 1 0 1 1 0 1 1 1 1 0 0 1 1 0 1 1 0 1 1 1 1 1 0 0 0 1 0 1 0\n[112] 0 1 1 0 0 1 0 0 0 1 1 1 0 1 1 0 1 0 0 0 1 0 1 1 1 0 0 1 1 0 1 1 0 1 0 1 0\n[149] 1 0 0 1 1 1 1 1 1 1 0 1 0 1 1 1 0 1 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1\n[186] 0 0 0 0 1 1 1 1 1 0 1 0 1 0 0"
  },
  {
    "objectID": "pensamiento.html#ejemplo-3-evaluación-práctica-1",
    "href": "pensamiento.html#ejemplo-3-evaluación-práctica-1",
    "title": "1  Pensamiento Bayesiano",
    "section": "1.3 Ejemplo 3 (Evaluación Práctica 1)",
    "text": "1.3 Ejemplo 3 (Evaluación Práctica 1)\nLos siguientes datos simulan el sexo de 200 recién nacidos, en donde 1 denota niño y 0 denota niña.\n\nrecien_n\n\n  [1] 1 1 1 0 1 1 1 1 0 1 0 0 1 0 1 1 1 1 1 0 0 0 0 1 1 0 0 1 0 1 1 1 1 0 1 0 0\n [38] 0 0 1 1 1 1 0 1 1 1 1 1 0 1 0 1 1 1 0 1 1 1 1 1 1 1 1 0 0 0 1 1 1 1 1 0 1\n [75] 1 1 1 0 1 1 0 1 1 0 1 1 0 1 1 1 1 0 0 1 1 0 1 1 0 1 1 1 1 1 0 0 0 1 0 1 0\n[112] 0 1 1 0 0 1 0 0 0 1 1 1 0 1 1 0 1 0 0 0 1 0 1 1 1 0 0 1 1 0 1 1 0 1 0 1 0\n[149] 1 0 0 1 1 1 1 1 1 1 0 1 0 1 1 1 0 1 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1\n[186] 0 0 0 0 1 1 1 1 1 0 1 0 1 0 0\n\n\nVamos a utilizar dos distintas formas de definir numéricamente la previa:\n\n1.3.1 Previa 1\nSe va a definir una previa usando una grilla de tamaño 1000 con 100000 muestras:\n\nset.seed(10)\np_prev_sample &lt;- runif(n = 100000)\nhisto_1 &lt;- hist(p_prev_sample,breaks = 1000)\n\n\n\np_post1 &lt;- data.frame(p = histo_1$breaks[-1],prev = histo_1$counts)\n\np_post1 &lt;- p_post1 %&gt;% mutate(prev = prev / sum(prev))\n\nCálculo de probabilidad posterior y valor de \\(p\\) que la maximiza:\n\ny &lt;- sum(recien_n)\nn_tot &lt;- length(recien_n)\np_post1 &lt;- p_post1 %&gt;% mutate(post = prev * p^y*(1-p)^(n_tot-y)) %&gt;%\n  mutate(post = post / sum(post))\nplot(p_post1$p,p_post1$post,type='l')\n\n\n\n\nValor que maximiza la posterior:\n\np_post1$p[which.max(p_post1$post)]\n\n[1] 0.606\n\n\n\n\n1.3.2 Previa 2\nSe va a definir una previa usando una grilla de tamaño 10 con 1000 muestras:\n\nset.seed(10)\np_prev_sample &lt;- runif(n = 1000)\nhisto_2 &lt;- hist(p_prev_sample,breaks = 10)\n\n\n\np_post2 &lt;- data.frame(p = histo_2$breaks[-1],prev = histo_2$counts)\n\np_post2 &lt;- p_post2 %&gt;% mutate(prev = prev / sum(prev))\n\nCálculo de probabilidad posterior y valor de \\(p\\) que la maximiza:\n\np_post2 &lt;- p_post2 %&gt;% mutate(post = prev * p^y*(1-p)^(n_tot-y)) %&gt;%\n  mutate(post = post / sum(post))\nplot(p_post2$p,p_post2$post,type='l')\n\n\n\n\nValor que maximiza la posterior:\n\np_post2$p[which.max(p_post2$post)]\n\n[1] 0.6\n\n\nDe ahora en adelante se utilizará la primera previa para calcular la muestra de tamaño 10000 de la distribución posterior:\n\nmuestra_post &lt;- sample(p_post1$p,replace = T,size = 10000,prob = p_post1$post)\n\nCálculo del intervalo de credibilidad al 90%:\n\nquantile(muestra_post,probs = c(0.05,0.95))\n\n   5%   95% \n0.552 0.666 \n\n\nde donde se deduce que con una probabilidad de 90%, el parámetro \\(p\\) (proporción de niños) esté contenido en el intervalo \\((0.55,0.67)\\).\nAhora vamos a estimar la probabilidad posterior de que un recién nacido fuera de la muestra sea niño:\n\ny_post &lt;- rbinom(n = 1000,prob = muestra_post,size = 1)\n\nprob_prediccion &lt;- sum(y_post)/1000\nprob_prediccion\n\n[1] 0.609"
  },
  {
    "objectID": "pensamiento.html#ejemplo-2-ejercicio-5-albert",
    "href": "pensamiento.html#ejemplo-2-ejercicio-5-albert",
    "title": "1  Pensamiento Bayesiano",
    "section": "1.2 Ejemplo 2 (Ejercicio 5, Albert)",
    "text": "1.2 Ejemplo 2 (Ejercicio 5, Albert)\nPrevia:\n\nprevia_mu &lt;- data.frame(mu = seq(20,70,by = 10),\n                        gmu = c(.1,.15,.25,.25,.15,.1))\n\nDatos:\n\ny_snow &lt;- c(38.6,42.4,57.5,40.5,51.7,67.1,33.4,\n            60.9,64.1,40.1,40.7,6.4)\ny_bar &lt;- mean(y_snow)\n\nVerosimilitud:\n\nposterior_mu &lt;- previa_mu %&gt;%\n  mutate(like = exp(-12/(2*10^2)*(mu-y_bar)^2))\n\nPosterior:\n\nposterior_mu &lt;- posterior_mu %&gt;% \n  mutate(post = gmu*like/sum(gmu*like))\nposterior_mu\n\n  mu  gmu         like         post\n1 20 0.10 2.201480e-17 1.954479e-17\n2 30 0.15 8.192991e-07 1.091063e-06\n3 40 0.25 1.873425e-01 4.158078e-01\n4 50 0.25 2.632064e-01 5.841881e-01\n5 60 0.15 2.272076e-06 3.025731e-06\n6 70 0.10 1.205079e-16 1.069871e-16\n\n\nIntervalo de credibilidad al 80% para \\(\\mu\\):\n\ndist_mu &lt;- posterior_mu %&gt;% select(mu,post)\ncovprob &lt;- .8\ndiscint(dist_mu,covprob)\n\n$prob\n[1] 0.9999959\n\n$set\n[1] 40 50\n\n\nTambién se podría estimar el intervalo de credibilidad vía simulación:\n\nmuestra_mu &lt;- sample(dist_mu$mu,size = 1000,replace = T,prob = dist_mu$post)\nquantile(muestra_mu,probs = c(0.1,0.9))\n\n10% 90% \n 40  50"
  },
  {
    "objectID": "pensamiento.html#ejemplo-2-ejercicio-5-capítulo-2-albert",
    "href": "pensamiento.html#ejemplo-2-ejercicio-5-capítulo-2-albert",
    "title": "1  Pensamiento Bayesiano",
    "section": "1.2 Ejemplo 2 (Ejercicio 5, Capítulo 2, Albert)",
    "text": "1.2 Ejemplo 2 (Ejercicio 5, Capítulo 2, Albert)\nPrevia:\n\nprevia_mu &lt;- data.frame(mu = seq(20,70,by = 10),\n                        gmu = c(.1,.15,.25,.25,.15,.1))\n\nDatos:\n\ny_snow &lt;- c(38.6,42.4,57.5,40.5,51.7,67.1,33.4,\n            60.9,64.1,40.1,40.7,6.4)\ny_bar &lt;- mean(y_snow)\n\nVerosimilitud:\n\nposterior_mu &lt;- previa_mu %&gt;%\n  mutate(like = exp(-12/(2*10^2)*(mu-y_bar)^2))\n\nPosterior:\n\nposterior_mu &lt;- posterior_mu %&gt;% \n  mutate(post = gmu*like/sum(gmu*like))\nposterior_mu\n\n  mu  gmu         like         post\n1 20 0.10 2.201480e-17 1.954479e-17\n2 30 0.15 8.192991e-07 1.091063e-06\n3 40 0.25 1.873425e-01 4.158078e-01\n4 50 0.25 2.632064e-01 5.841881e-01\n5 60 0.15 2.272076e-06 3.025731e-06\n6 70 0.10 1.205079e-16 1.069871e-16\n\n\nIntervalo de credibilidad al 80% para \\(\\mu\\):\n\ndist_mu &lt;- posterior_mu %&gt;% select(mu,post)\ncovprob &lt;- .8\ndiscint(dist_mu,covprob)\n\n$prob\n[1] 0.9999959\n\n$set\n[1] 40 50\n\n\nTambién se podría estimar el intervalo de credibilidad vía simulación:\n\nmuestra_mu &lt;- sample(dist_mu$mu,size = 1000,replace = T,prob = dist_mu$post)\nquantile(muestra_mu,probs = c(0.1,0.9))\n\n10% 90% \n 40  50"
  },
  {
    "objectID": "unparametro.html#ejemplo-1",
    "href": "unparametro.html#ejemplo-1",
    "title": "2  Modelos de un parámetro",
    "section": "2.1 Ejemplo 1",
    "text": "2.1 Ejemplo 1\nAnálisis del ejemplo de la página 37 del Gelman.\nUn estudio alemán concluyó que de un total de 980 nacimientos con condición de placenta previa, 437 nacieron niñas.\nPregunta de investigación: Qué tan evidente es la afirmación de que en la población de nacimientos de placenta previa, la proporción de nacimientos femeninos sea menor a 0.485?"
  },
  {
    "objectID": "unparametro.html#primera-previa",
    "href": "unparametro.html#primera-previa",
    "title": "2  Modelos de un parámetro",
    "section": "2.2 Primera previa",
    "text": "2.2 Primera previa\nSuponga que \\(\\theta\\): proporción de niñas que nacieron bajo la condición de placenta previa. Usando una previa uniforme para \\(\\theta\\) en (0,1), la media posterior es \\(Beta(438,544)\\):\n\na_post &lt;- 438\nb_post &lt;- 544\n\npor lo tanto la media y la desviación posterior del parámetro \\(\\theta\\) es:\n\nmedia_post &lt;- a_post/(a_post+b_post)\nsd_post &lt;- sqrt(media_post*(1-media_post)/983)\n\nComo la posterior es beta, se puede calcular directamente que un intervalo de credibilidad al 95% es \\((0.415,0.477)\\), lo cual se puede comprobar de manera aproximada al calcular:\n\npbeta(0.477,shape1 = a_post,shape2 = b_post)-\n  pbeta(0.415,shape1 = a_post,shape2 = b_post)\n\n[1] 0.9495027\n\n\nPor la justificación vista en clase, se puede aproximar la distribución posterior con una distribución normal y calcular directamente los límites del intervalo de credibilidad a como sigue:\n\ncuantil0975_norm &lt;- media_post+qnorm(0.975)*sd_post\ncuantil025_norm &lt;- media_post-qnorm(0.975)*sd_post\nc(cuantil025_norm,cuantil0975_norm)\n\n[1] 0.4149546 0.4771025\n\n\nAsimismo, podemos obtener una muestra aleatoria de la posterior de la sifuiente forma:\n\ntheta_post &lt;- rbeta(1000,shape1 = a_post,b_post)\nhist(theta_post)\n\n\n\n\ny así calcular el mismo intervalo de credibilidad:\n\nquantile(theta_post,probs = c(0.025,0.975))\n\n     2.5%     97.5% \n0.4137056 0.4769427 \n\n\ny un estimador puntual bayesiano para \\(\\theta\\):\n\nmedian(theta_post)\n\n[1] 0.4451357\n\n\nPor otro lado también podemos usar la reparametrización \\(\\phi=\\log\\left(\\frac{\\theta}{1-\\theta}\\right)\\) para aplicar la aproximación normal sobre un parámetro totalmente definido en \\(\\mathbb R\\):\n\nphi_post &lt;- log(theta_post/(1-theta_post))\nhist(phi_post)\n\n\n\nphi_mean &lt;- mean(phi_post)\nphi_sd &lt;- sd(phi_post)\n\ny de esta forma aproximar el mismo intervalo de credibilidad para \\(\\theta\\), usando la transformación logística:\n\nlogistico &lt;- function(u){\n  exp(u)/(1+exp(u))\n}\n\nlogistico(phi_mean+qnorm(0.975)*phi_sd)\n\n[1] 0.4766789\n\nlogistico(phi_mean-qnorm(0.975)*phi_sd)\n\n[1] 0.4133679\n\n\nTambién podemos hacer inferencia sobre la razón niña/niño (\\(\\theta/(1-\\theta)\\)):\n\nrazon_post &lt;- theta_post/(1-theta_post)\nquantile(razon_post,probs = c(0.025,0.975))\n\n     2.5%     97.5% \n0.7056280 0.9118364 \n\n\nLa pregunta de investigación puede ser contestada al calcular lo siguiente e interpretarlo de forma apropiada según lo comentado en clase:\n\npbeta(0.485,shape1 = a_post,shape2 = b_post)\n\n[1] 0.992826\n\n\nAsimismo, podemos calcular el periodo de retorno del evento principal al calcular:\n\n1/pbeta(0.485,shape1 = a_post,shape2 = b_post,lower.tail = F)\n\n[1] 139.392"
  },
  {
    "objectID": "unparametro.html#ejemplo-2",
    "href": "unparametro.html#ejemplo-2",
    "title": "2  Modelos de un parámetro",
    "section": "2.3 Ejemplo 2",
    "text": "2.3 Ejemplo 2\nDesarrollamos una solución alternativa al ejemplo en la sección 3.2 del Albert:\nEn este caso se tiene datos correspondientes a las diferencias entre los resultados de partidos de fútbol americano y “point spreads”:\n\nlibrary(LearnBayes)\ndata(\"footballscores\")\nattach(footballscores)\nd &lt;- favorite-underdog-spread\n\nSi asumimos un modelo normal en las diferencias con media 0 y varianza \\(\\sigma^2\\), el estadístico suficiente respectivo es:\n\nv &lt;- sum(d^2)\nn &lt;- length(d)\nshow(v)\n\n[1] 128902\n\n\nAsumiendo una distribución previa \\(Inv-\\chi^2(v_0=1, \\sigma^2_0=1)\\), según lo visto en clase, la probabilidad posterior de \\(\\sigma^2\\) es \\(Inv-\\chi^2(v_1=n+1, \\sigma^2_1=nv+1)\\) en donde:\n\nv1 &lt;- n+1\nsigma1 &lt;- sqrt(n*v+1) \n\nSimulamos una muestra de tamaño 1000 de la distribución posterior de \\(\\sigma^2\\). Noten que la simulación usa las propiedades de una chi-cuadrado inversa.\n\nXpost &lt;- rchisq(n = 1000,df = n+1) \nZ &lt;- 1/Xpost\nsigma2_post &lt;- sigma1*Z\n\nO bien pueden usar la siguiente función que simula las muestras directamente:\n\nlibrary(LaplacesDemon)\n\n\nAttaching package: 'LaplacesDemon'\n\n\nThe following object is masked from 'package:LearnBayes':\n\n    rdirichlet\n\nsigma2_post2 &lt;- rinvchisq(n = 1000,df = v1,scale = sigma1/v1)\n\nNoten que el parametro de escala en esta función hay que dividirlo por los grados de libertad para que sea igual al que definimos en clase. En ambos casos se puede calcular un intervalo de credibilidad al 95% y un estimador puntual de \\(\\sigma^2\\):\n\nquantile(sigma2_post, probs = c(0.025, 0.5, 0.975))\n\n    2.5%      50%    97.5% \n12.50771 13.81855 15.51500 \n\nquantile(sigma2_post2, probs = c(0.025, 0.5, 0.975))\n\n    2.5%      50%    97.5% \n12.39380 13.80629 15.41711"
  },
  {
    "objectID": "unparametro.html#ejemplo-3",
    "href": "unparametro.html#ejemplo-3",
    "title": "2  Modelos de un parámetro",
    "section": "2.4 Ejemplo 3",
    "text": "2.4 Ejemplo 3\nConsidere el ejemplo de la página 45 del Gelman, en donde se modela la tasa de muerte producto del asma en una ciudad de Estados Unidos. La población de la ciudad es de 200000 personas. En un año han fallecido 3 personas, dando una tasa cruda de:\n\n3/200000\n\n[1] 1.5e-05\n\n\n1.5 muertes por 100000 habitantes. Asumimos que el conteo de muertes \\(y\\sim Poisson(2\\theta)\\) indicando que la tasa se mide en número de casos por 100000 habitantes, con una población expuesta de \\(2\\times 100000\\) habitantes. Asumiendo una previa \\(\\theta \\sim Gamma(3,5)\\) se tiene un valor esperado (previo) de la tasa de muerte de:\n\n3/5\n\n[1] 0.6\n\n\npor cada 100000 habitantes. Note que en este caso hay una probabilidad previa de más de un 97.5% de que la tasa de muerte esté por debajo de 1.44:\n\npgamma(1.5,shape = 3,rate = 5)\n\n[1] 0.9797433\n\n\nUna muestra posterior de \\(\\theta\\) asumiendo que \\(y=3\\) es:\n\ntheta_post &lt;- rgamma(n = 1000,shape = 6,rate = 7)\n\ny gráficamente:\n\nhist(theta_post)\n\n\n\n\ny un intervalo de credibilidad al 95% sería:\n\nquantile(theta_post, probs = c(0.025, 0.5, 0.975))\n\n     2.5%       50%     97.5% \n0.3243252 0.8210934 1.6520077 \n\n\nSi se observara la misma cantidad de muertes por año en la misma ciudad en un periodo de 10 años, y asumimos que la población es constante, la posterior la podemos muestrear de la siguiente forma:\n\ntheta_post2 &lt;- rgamma(n = 1000,shape = 33,rate = 25)\nhist(theta_post2)\n\n\n\n\ny el intervalo de credibilidad correspondiente para \\(\\theta\\) al 95% sería:\n\nquantile(theta_post2, probs = c(0.025, 0.5, 0.975))\n\n    2.5%      50%    97.5% \n0.931524 1.310252 1.854992"
  },
  {
    "objectID": "unparametro.html#evaluación-práctica-2",
    "href": "unparametro.html#evaluación-práctica-2",
    "title": "2  Modelos de un parámetro",
    "section": "2.5 Evaluación Práctica 2",
    "text": "2.5 Evaluación Práctica 2\nTiempo de quemado de las cinco bombillas:\n\ny &lt;- c(751,594,1213,1126,819)\n\nSimulación de la distribución posterior de \\(\\theta\\):\n\nn_tot &lt;- length(y)\ns &lt;- sum(y)\ntheta_post &lt;- rgamma(n = 1000,shape = n_tot,rate = s)\nhist(theta_post)\n\n\n\n\nMuestra posterior de \\(\\lambda\\):\n\nlambda_post &lt;- 1/theta_post\nhist(lambda_post)\n\n\n\n\nLa probabilidad posterior de que \\(\\lambda\\) exceda las 1000 horas se puede estimar:\n\nsum(lambda_post&gt;1000)/1000\n\n[1] 0.446\n\n\nLa probabilidad predictiva posterior del tiempo de quemado de una bombilla es:\n\ny_tilde &lt;- rexp(n = 1000,rate = 1/lambda_post)\ny_tilde_freq &lt;- hist(y_tilde,breaks = 20)\n\n\n\ny_tilde_x &lt;- y_tilde_freq$mids\ny_tilde_post &lt;- y_tilde_freq$counts/1000\nplot(y_tilde_x,y_tilde_post,type='l',ylab = 'Prob. Post.')\n\n\n\n\nIntervalo de credibilidad al 90% para el tiempo de quemado:\n\nquantile(y_tilde,probs = c(0.05,0.95))\n\n        5%        95% \n  44.79943 3585.42291"
  },
  {
    "objectID": "variosparametros.html#ejemplo-1.-página-66-gelman.",
    "href": "variosparametros.html#ejemplo-1.-página-66-gelman.",
    "title": "3  Modelos de varios parámetros",
    "section": "3.1 Ejemplo 1. Página 66, Gelman.",
    "text": "3.1 Ejemplo 1. Página 66, Gelman.\nCargamos la librería MASS, que contiene los datos del experimento de Simon Newcomb en 1882:\n\nlibrary(MASS)\ndata(\"newcomb\")\n\nRecuerden que se busca estimar la velocidad media en la que la luz viaja en una distancia de 7442 metros.\nHistograma de los datos observados por Newcomb:\n\nhist(newcomb,breaks = 40)\n\n\n\n\ndonde se nota un cierto grado de simetría en la densidad excepto por los dos valores negativos de la serie.\nCon el fin de generar una muestra posterior multivariada de \\((\\mu,\\sigma^2)\\), primero generamos la muestra posterior de \\(\\sigma^2\\):\n\ns2 &lt;- var(newcomb)\nsigma2_pre &lt;- rchisq(n = 1000,df = 65)\nsigma2_post &lt;- sqrt(s2)/sigma2_pre\nhist(sigma2_post)\n\n\n\n\nla cual es una muestra de una variable según \\(Inv-\\chi^2(n-1,s^2)\\). La muestra de la media \\(\\mu|\\sigma^2,y\\) es:\n\nn_tot &lt;- length(newcomb)\nybar &lt;- mean(newcomb)\nmu_post &lt;- rnorm(n = 1000,mean = ybar,sd = sqrt(sigma2_post/n_tot))\nhist(mu_post)\n\n\n\n\nUn intervalo de credibilidad al 90% para \\(\\mu\\) (dado que \\(\\sigma\\) es fijo) es:\n\nquantile(mu_post,probs = c(0.05,0.95))\n\n      5%      95% \n26.12713 26.29632 \n\n\nVale la pena compararlo con un intervalo de credibilidad para \\(\\mu\\) sin considerar \\(\\sigma\\) fijo:\n\nybar + c(-1,1)*qt(0.95,df = 65)*sqrt(s2/n_tot)\n\n[1] 24.00509 28.41916\n\n\nel cual por supuesto va a ser más disperso.\nLa distribución posterior predictiva de una nueva observación del experimento, se infiere a través de una muestra:\n\ny_tilde_post &lt;- rnorm(n = 1000,mean = mu_post,sd = sqrt(sigma2_post))\nhist(y_tilde_post)\n\n\n\nquantile(y_tilde_post,probs = c(0.05,0.95))\n\n      5%      95% \n25.49366 26.87430 \n\n\ny este ultimo sería el intervalo de credibilidad al 90% para la nueva observación \\(\\tilde y\\)."
  },
  {
    "objectID": "variosparametros.html#ejemplo-2-sección-4.2-albert.",
    "href": "variosparametros.html#ejemplo-2-sección-4.2-albert.",
    "title": "3  Modelos de varios parámetros",
    "section": "3.2 Ejemplo 2: sección 4.2, Albert.",
    "text": "3.2 Ejemplo 2: sección 4.2, Albert.\nDatos de tiempos (en minutos) de corredores de maratón con edades entre 20 y 29 años:\n\nlibrary(LearnBayes)\ndata(\"marathontimes\")\nattach(marathontimes)\nhist(time)\n\n\n\n\nAsimismo se puede graficar una figura de contorno:\n\nd = mycontour(normchi2post, c(220, 330, 500, 9000), time,xlab=\"mean\",ylab=\"variance\")\n\n\n\n\nPor otro lado generamos una muestra posterior de los dos parámetros de interés, para incorporarlos en el gráfico anterior:\n\nS &lt;- sum((time-mean(time))^2)\n\nn &lt;- length(time)\n\nsigma2_post &lt;- S/rchisq(1000,n-1)\nhist(sigma2_post)\n\n\n\nmu_post &lt;- rnorm(n = 1000,mean = mean(time),sd = sqrt(sigma2_post/n))\nhist(mu_post)\n\n\n\n\nIncorporamos la muestra en el gráfico de la log-densidad-posterior:\n\nd = mycontour(normchi2post, c(220, 330, 500, 9000), time,xlab=\"mean\",ylab=\"variance\")\npoints(mu_post,sigma2_post)\n\n\n\n\nIntervalos de credibilidad para \\(\\mu|\\sigma^2, y\\) (en horas) y para \\(\\sigma^2|y\\) son:\n\nquantile(mu_post,c(0.025,0.975))/60\n\n    2.5%    97.5% \n4.271898 4.996973 \n\nquantile(sqrt(sigma2_post),c(0.025,0.975))\n\n    2.5%    97.5% \n37.90798 70.31487"
  },
  {
    "objectID": "variosparametros.html#ejemplo-3-sección-4.3-del-albert",
    "href": "variosparametros.html#ejemplo-3-sección-4.3-del-albert",
    "title": "3  Modelos de varios parámetros",
    "section": "3.3 Ejemplo 3: sección 4.3 del Albert",
    "text": "3.3 Ejemplo 3: sección 4.3 del Albert"
  },
  {
    "objectID": "variosparametros.html#evaluación-práctica-3",
    "href": "variosparametros.html#evaluación-práctica-3",
    "title": "3  Modelos de varios parámetros",
    "section": "3.4 Evaluación Práctica 3",
    "text": "3.4 Evaluación Práctica 3"
  }
]
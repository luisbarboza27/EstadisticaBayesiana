[
  {
    "objectID": "pensamiento.html",
    "href": "pensamiento.html",
    "title": "Pensamiento Bayesiano",
    "section": "",
    "text": "Librerías:\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(LearnBayes)\n\n\n\n\nPregunta de investigación: ¿Qué proporción de estudiantes universitarios duermen al menos 8 horas diarias?\nNotación: \\(p\\): proporción de estudiantes que duermen al menos 8 horas diarias.\nDatos: Muestra de 27 estudiantes donde 11 sí durmieron al menos 8 horas ayer.\nModelo: \\[L(p)\\propto p^s(1-p)^f\\]\nDistribución posterior: Si \\(g(p)\\) es la densidad previa de \\(p\\), entonces: \\[g(p|\\text{datos})\\propto g(p)L(p)\\] Primera escogencia de previa \\(g(p)\\)\n\n\np &lt;- seq(0.05,0.95,by = 0.1)\nprevia &lt;- c(1,5.2,8,7.2,4.6,2.1,0.7,0.1,0,0)\nprevia &lt;- previa / sum(previa)\nplot(p, previa, type = \"h\", ylab=\"Probabilidad previa\")\n\n\n\n\n\ndatos_sleep &lt;- c(11, 16)\ndatos_tot &lt;- data.frame(p = p, previa = previa)\ndatos_tot &lt;- datos_tot %&gt;% mutate(posterior = previa* p^(11)*(1-p)^(16)) %&gt;%\n  mutate(posterior = posterior/sum(posterior)) \nround(datos_tot,2)\n\n      p previa posterior\n1  0.05   0.03      0.00\n2  0.15   0.18      0.00\n3  0.25   0.28      0.13\n4  0.35   0.25      0.48\n5  0.45   0.16      0.33\n6  0.55   0.07      0.06\n7  0.65   0.02      0.00\n8  0.75   0.00      0.00\n9  0.85   0.00      0.00\n10 0.95   0.00      0.00\n\n\nComparación:\n\ndatos_tot_long &lt;- datos_tot %&gt;%\n  pivot_longer(previa:posterior,names_to = 'Type',values_to = 'Probability')\n\nggplot(datos_tot_long, aes(x = p, y = Probability, group = Type, color = Type)) +\n  geom_line(linewidth = 3) +\n  facet_wrap(~ Type, nrow =  2) +\n  theme_minimal()\n\n\n\n\nSegunda escogencia de previa \\(g(p)\\)"
  },
  {
    "objectID": "pensamiento.html#ejemplo-1",
    "href": "pensamiento.html#ejemplo-1",
    "title": "1  Pensamiento Bayesiano",
    "section": "1.1 Ejemplo 1",
    "text": "1.1 Ejemplo 1\n\nPregunta de investigación: ¿Qué proporción de estudiantes universitarios duermen al menos 8 horas diarias?\nNotación: \\(p\\): proporción de estudiantes que duermen al menos 8 horas diarias.\nDatos: Muestra de 27 estudiantes donde 11 sí durmieron al menos 8 horas ayer.\nModelo: \\[L(p)\\propto p^s(1-p)^f\\]\nDistribución posterior: Si \\(g(p)\\) es la densidad previa de \\(p\\), entonces: \\[g(p|\\text{datos})\\propto g(p)L(p)\\] Primera escogencia de previa \\(g(p)\\)\n\n\np &lt;- seq(0.05,0.95,by = 0.1)\nprevia &lt;- c(1,5.2,8,7.2,4.6,2.1,0.7,0.1,0,0)\nprevia &lt;- previa / sum(previa)\nplot(p, previa, type = \"h\", ylab=\"Probabilidad previa\")\n\n\n\n\n\ndatos_sleep &lt;- c(11, 16)\ndatos_tot &lt;- data.frame(p = p, previa = previa)\ndatos_tot &lt;- datos_tot %&gt;% mutate(posterior = previa* p^(11)*(1-p)^(16)) %&gt;%\n  mutate(posterior = posterior/sum(posterior)) \nround(datos_tot,2)\n\n      p previa posterior\n1  0.05   0.03      0.00\n2  0.15   0.18      0.00\n3  0.25   0.28      0.13\n4  0.35   0.25      0.48\n5  0.45   0.16      0.33\n6  0.55   0.07      0.06\n7  0.65   0.02      0.00\n8  0.75   0.00      0.00\n9  0.85   0.00      0.00\n10 0.95   0.00      0.00\n\n\nComparación:\n\ndatos_tot_long &lt;- datos_tot %&gt;%\n  pivot_longer(previa:posterior,names_to = 'Type',values_to = 'Probability')\n\nggplot(datos_tot_long, aes(x = p, y = Probability, group = Type, color = Type)) +\n  geom_line(linewidth = 3) +\n  facet_wrap(~ Type, nrow =  2) +\n  theme_minimal()\n\n\n\n\nSegunda escogencia de previa \\(g(p)\\)\nEscogencia de los parámetros de la Beta:\n\nquantile1 &lt;- list(p = .5,x=.3)\nquantile2 &lt;- list(p=.9,x=.5)\nbeta.select(quantile1,quantile2)\n\n[1] 3.26 7.19\n\n\nComparación de densidades:\n\na &lt;- 3.26\nb &lt;- 7.19\ns &lt;- 11\nf &lt;- 16\n\nx_values &lt;- seq(0, 1, length.out = 1000)\ndf &lt;- data.frame(x = x_values,\n                 Prior = dbeta(x_values, a, b),\n                 Likelihood = dbeta(x_values, s + 1, f + 1),\n                 Posterior = dbeta(x_values, a + s, b + f))\n\n\nggplot(df, aes(x)) +\n  geom_line(aes(y = Prior), linetype = \"dashed\", size = 1.5, color = \"blue\") +\n  geom_line(aes(y = Likelihood), linetype = \"dotted\", size = 1.5, color = \"green\") +\n  geom_line(aes(y = Posterior), size = 1.5, color = \"red\") +\n  labs(x = \"p\", y = \"Density\") +\n  theme_minimal() +\n  scale_color_manual(values = c(\"blue\", \"green\", \"red\")) +\n  theme(legend.position = \"top\") +\n  guides(color = guide_legend(title = \"Density\"))\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\nPara responder parcialmente la pregunta de investigación:\n\n1 - pbeta(0.5, a + s, b + f)\n\n[1] 0.0690226\n\n\nes decir hay una probabilidad aproximadamente de 7% de que más de la mitad de los estudiantes universitarios duerman más de 8 horas diarias. O bien, si se quiere calcular la probabilidad de que la proporción de estudiantes sea mayor a lo observado:\n\n1 - pbeta(11/27, a + s, b + f)\n\n[1] 0.3603559\n\n\nIntervalo de credibilidad para \\(p\\):\n\nqbeta(c(0.05, 0.95), a + s, b + f)\n\n[1] 0.2555267 0.5133608\n\n\nen donde se infiere que \\(p\\) tiene una probabilidad del 95% de estar ubicado entre esos dos valores. El resultado anterior que es exacto, se puede aproximar usando simulación:\n\nps &lt;- rbeta(1000, a + s, b + f)\nhist(ps,xlab=\"p\",main=\"\")\n\n\n\n\ny la probabilidad de que \\(p&gt;0.5|\\text{datos}\\) se puede aproximar empíricamente:\n\nsum(ps &gt;= 0.5)/1000\n\n[1] 0.068\n\n\ny el intervalo de credibilidad correspondiente:\n\nquantile(ps, c(0.05, 0.95))\n\n       5%       95% \n0.2570154 0.5139937 \n\n\n\n1.1.1 Predicción\nBajo la primera previa:\n\np &lt;- seq(0.05, 0.95, by=.1)\nprior &lt;- c(1, 5.2, 8, 7.2, 4.6, 2.1, 0.7, 0.1, 0, 0)\nprior &lt;- prior/sum(prior)\nm &lt;- 20\nys &lt;- 0:20\npred &lt;- pdiscp(p, prior, m, ys)\nround(cbind(0:20,pred),3)\n\n          pred\n [1,]  0 0.020\n [2,]  1 0.044\n [3,]  2 0.069\n [4,]  3 0.092\n [5,]  4 0.106\n [6,]  5 0.112\n [7,]  6 0.110\n [8,]  7 0.102\n [9,]  8 0.089\n[10,]  9 0.074\n[11,] 10 0.059\n[12,] 11 0.044\n[13,] 12 0.031\n[14,] 13 0.021\n[15,] 14 0.013\n[16,] 15 0.007\n[17,] 16 0.004\n[18,] 17 0.002\n[19,] 18 0.001\n[20,] 19 0.000\n[21,] 20 0.000\n\n\nBajo la segunda previa (beta):\n\nfy &lt;- choose(m,ys)*beta(a+ys,b = b+m-ys)/beta(a,b)\nab &lt;- c(3.26, 7.19)\npred &lt;- pbetap(ab, m, ys)\n\nO por simulación:\n\np &lt;- rbeta(1000, 3.26, 7.19)\ny &lt;- rbinom(1000, 20, p)\ntable(y)\n\ny\n  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18 \n 19  42  59  85  97 119 116 119  82  79  52  44  40  19  12   8   5   2   1 \n\n\n\nfreq &lt;- table(y)\nys &lt;- as.integer(names(freq))\npredprob &lt;- freq / sum(freq)\n\ndf &lt;- data.frame(ys = ys, predprob = predprob)\n\n\nggplot(df, aes(x = ys, y = predprob)) +\n  geom_line(stat = \"identity\", type = \"h\", color = \"blue\", size = 1.5) +\n  labs(x = \"y\", y = \"Predictive Probability\") +\n  theme_minimal()\n\nWarning in geom_line(stat = \"identity\", type = \"h\", color = \"blue\", size =\n1.5): Ignoring unknown parameters: `type`\n\n\nDon't know how to automatically pick scale for object of type &lt;table&gt;.\nDefaulting to continuous.\n\n\n\n\n\nCálculo de intervalo de credibilidad al 90% usando la probabilidad predictiva anterior:\n\ndist &lt;- cbind(ys,predprob)\ncovprob &lt;- .9\ndiscint(dist,covprob)\n\n$prob\n   12 \n0.934 \n\n$set\n 1  2  3  4  5  6  7  8  9 10 11 12 \n 1  2  3  4  5  6  7  8  9 10 11 12"
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "Summary",
    "section": "",
    "text": "Summary\nIn summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "References"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Inferencia Bayesiana",
    "section": "",
    "text": "Prefacio\nNotas computacionales del curso XS0128 (Inferencia Bayesiana) para el I-2024."
  }
]